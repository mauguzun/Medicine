version: '3'

services:

  postgres:
    image: postgres:latest
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: mydb
    ports:
      - "5432:5432"  
    volumes:
      - ./sql:/docker-entrypoint-initdb.d

  db-importer:
    depends_on:
      - postgres
    image: postgres:latest
    volumes:
      - ./sql:/docker-entrypoint-initdb.d
    entrypoint: ["/bin/bash", "-c"]
    command: |
      echo "--------------------------------Contents of SQL script:"
      cat /docker-entrypoint-initdb.d/init.sql
      
      psql -h postgres -U postgres -d mydb -f /docker-entrypoint-initdb.d/public.sql